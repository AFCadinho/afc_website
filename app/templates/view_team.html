{% extends 'base.html' %}

{% block title %}
View Team
{% endblock %}

{% block content %}
<h2>{{ team.name }}</h2>

<a href="{{ team.pokepaste }}">Click for Pokepaste</a>
{% if session["is_admin"] %}
<form action="{{ url_for('teams.delete_team', team_id=team.id ) }}" method="POST">
    <button type="submit" class="delete_button">Delete Team</button>
</form>  
{% endif %}

<!-- Add comment -->
<h3>Add a Comment</h3>
<form action="{{ url_for('teams.view_team', team_id=team.id) }}" method="POST">
    <input type="hidden" name="csrf_token" value="{{ session['csrf_token'] }}">
    <textarea name="comment" rows="4" cols="50" placeholder="Write your comment"></textarea><br>
    <button type="submit">Comment</button>
</form>

<!-- Display comments -->
<h3>Comments</h3>
{% if comments %}
<ul>
    {% for comment in comments %}
    <li>        
        <strong>From: {{ comment.users.name }}</strong>
        <p>{{ comment.comment }}</p>
        <small>Posted on {{ comment.created_at.strftime('%d-%m-%Y %H:%M') }}</small>
        {% if comment.user_id == session["user_id"] or session["is_admin"] %}
        <form action="{{ url_for('teams.delete_team_comment', team_id=team.id, comment_id=comment.id) }}" method="POST">
            <button type="submit" class="delete_button">Delete Comment</button>
        </form>     
        {% endif %}
    </li>
    {% endfor %}
</ul>
{% else %}
<p>No comments yet. Be the first to comment!</p>
{% endif %}
{% endblock %}
